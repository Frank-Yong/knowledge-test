# OperatingContextMcp Session Log

- Timestamp: 2026-02-25 20:43:50 (local)
- Source repo: operating-context-mcp
- Branch: phase-2-mcp-handshake
- Trigger: review fix + `log it`

## Change implemented

### Oversized Content-Length DoS hardening
- File: `src/OperatingContextMcp.Server/Worker.cs`
- Updated oversized payload handling (`contentLength > MaxContentBytes`):
  - no longer attempts to drain full declared payload length
  - drains only a bounded amount (`MaxOversizeDiscardBytes = 64KB`)
  - then throws fatal protocol exception
- Main MCP loop now treats this as fatal:
  - logs error
  - stops server loop

## Why this matters
- Prevents long blocking drain attempts for attacker-controlled huge `Content-Length` values.
- Avoids single-threaded stdio loop DoS via excessive discard work.
- Keeps behavior explicit: oversized frame is a protocol-breaking event.

## Validation
- Command: `dotnet build src/OperatingContextMcp.sln`
- Result: succeeded.

## Status snapshot
- PR #3 remains active with ongoing transport hardening fixes.
- Functional backlog unchanged (`knowledge_search`, `knowledge_refresh`).
