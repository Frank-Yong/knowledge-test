# OperatingContextMcp Session Log

- Timestamp: 2026-02-26 04:51:07 (local)
- Source repo: operating-context-mcp
- Branch: phase-2-mcp-handshake
- Trigger: review fix + `log it`

## Change implemented

### JSON-RPC error code mapping for invalid params
- File: `src/OperatingContextMcp.Server/Worker.cs`
- Added `InvalidParamsException` and mapped it to JSON-RPC `-32602` in `HandleRequestAsync`.
- Kept `-32000` for true internal/server errors only.
- Updated `tools/call` validation flow to throw `InvalidParamsException` for client input issues:
  - missing `params`
  - missing/empty `params.name`
  - missing required `knowledge_get` arguments
  - invalid `knowledge_get` argument shape / deserialization errors
  - arguments supplied to tools that do not accept arguments yet
- Adjusted logging level for invalid params path to `Information` to reduce warning noise from expected bad input.

## Why this matters
- Aligns JSON-RPC/MCP behavior: client request-shape issues are surfaced as `-32602`.
- Preserves `-32000` for server-side failures.
- Gives clients clearer feedback and cleaner telemetry.

## Validation
- Command: `dotnet build src/OperatingContextMcp.sln`
- Result: succeeded.

## Status snapshot
- PR #3 is still the active handshake/transport PR.
- Remaining roadmap backlog unchanged (`knowledge_search`, `knowledge_refresh`).
