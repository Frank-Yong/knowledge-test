# OperatingContextMcp Session Log

- Timestamp: 2026-02-25 20:09:30 (local)
- Source repo: operating-context-mcp
- Branch: phase-2-mcp-handshake
- Trigger: explicit `log it`

## Change implemented

### JSON-RPC invalid request compliance
- File: `src/OperatingContextMcp.Server/Worker.cs`
- Updated request validation flow in the MCP loop:
  - Extracts `id` before checking `method`.
  - If `method` is missing or empty **and** request has `id`, server now returns JSON-RPC error:
    - `code: -32600`
    - `message: "Invalid Request"`
  - Requests without `id` continue to be treated as notifications and ignored when malformed.

## Why this matters
- Avoids silently dropping malformed request objects that clients expect a response for.
- Improves client behavior and protocol compatibility under bad request conditions.

## Validation
- Command: `dotnet build src/OperatingContextMcp.sln`
- Result: succeeded.

## Current phase snapshot
- Phase 2 handshake/transport implementation active and hardened through review fixes.
- Remaining roadmap items still pending:
  - `knowledge_search`
  - `knowledge_refresh` with SHA checks

## PR context
- Active PR: #3 (`Phase 2: add MCP stdio transport and handshake`)
- This log captures one of the post-PR review remediation updates.
